<!DOCTYPE html>
<html lang="en">
<head>
    <title>Day 1: WebSocket Echo</title>
</head>
<body>
    <h1>WebSocket Echo Test</h1>
    <input type="text" id="messageInput" placeholder="Type a message..." autofocus />
    <button id="sendButton">Send</button>
    <h3>Log:</h3>
    <div id="messages"></div>

    <script>
        const messageInput = document.getElementById('messageInput');
        const sendButton = document.getElementById('sendButton');
        const messagesDiv = document.getElementById('messages');

        // 1. Establish WebSocket connection with the server
        // Note: 'ws://' is for unencrypted connections.
        const socket = new WebSocket('ws://localhost:8080');

        // 2. Handle the 'open' event: fires when the connection is ready
        socket.onopen = () => {
            console.log('WebSocket connection opened!');
            messagesDiv.innerHTML += '<p><em>Connection to server established!</em></p>';
        };

        // 3. Handle the 'message' event: fires when a message arrives from the server
        socket.onmessage = (event) => {
            console.log(`Message from server: ${event.data}`);
            messagesDiv.innerHTML += `<p><strong>Server:</strong> ${event.data}</p>`;
        };

        // 4. Handle the 'close' event: fires if the connection is lost
        socket.onclose = () => {
            console.log('WebSocket connection closed.');
            messagesDiv.innerHTML += '<p><em>Connection to server lost!</em></p>';
        };

        // 5. Send a message when the button is clicked
        sendButton.onclick = () => {
            const message = messageInput.value;
            socket.send(message);
            messagesDiv.innerHTML += `<p><strong>You:</strong> ${message}</p>`;
            messageInput.value = '';
        };
    </script>
</body>
</html>